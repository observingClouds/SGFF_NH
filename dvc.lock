schema: '2.0'
stages:
  patterns_along_traj:
    cmd: python patterns_along_trajectory.py
    deps:
    - path: ../data/ERA5/trajectories/Trajectories_back_ClassificationCenters_IR.nc
      md5: dec7390e2ba1db4fd9da291db1363ff8
      size: 6107971
    - path: ../data/SGFF/Daily_1x1_MODIS-IR_NorthAtlantic_SGFF.nc
      md5: 3d4d99222e23d60a52e04a8d4f21bd90
      size: 2285993
    outs:
    - path: ../data/result/patterns_along_trajectories.pq
      md5: 2e7b90d96f16556b006fc2969b74929f
      size: 93253
    - path: ../figures/patterns_along_trajectory.pdf
      md5: fa443afbba6b5319a0b33ab7a5d6e862
      size: 14984
  get_patterns_along_traj:
    cmd: python get_patterns_along_traj.py
    deps:
    - path: ../data/ERA5/trajectories/Trajectories_back_ClassificationCenters_IR.nc
      md5: dec7390e2ba1db4fd9da291db1363ff8
      size: 6107971
    - path: ../data/MCC/Daily_1x1_MODIS_C6_MCC_2018.nc
      md5: 9a0df9cb9a139b13e7dbc9447774621e
      size: 268733068
    - path: ../data/MEASURES/Daily_1x1_MEASURES_CLASS_2018.nc
      md5: 7e48a5e767948301294543799c9ca415
      size: 332532770
    - path: ../data/SGFF/Daily_1x1_MODIS-IR_NorthAtlantic_SGFF.nc
      md5: 3d4d99222e23d60a52e04a8d4f21bd90
      size: 2285993
    outs:
    - path: ../data/result/patterns_along_trajectories_MCC.pq
      md5: 89788ab7db179f59fc26469e4660e9a5
      size: 65179
    - path: ../data/result/patterns_along_trajectories_MEASURES.pq
      md5: 6e3beb184f76b7994377a804ba695a1b
      size: 71864
    - path: ../data/result/patterns_along_trajectories_SGFF.pq
      md5: 2e7b90d96f16556b006fc2969b74929f
      size: 93253
  plot_patterns_along_traj_all_datasets:
    cmd: python patterns_along_trajectory_alldatasets.py
    deps:
    - path: ../data/ERA5/trajectories/Trajectories_back_ClassificationCenters_IR.nc
      md5: dec7390e2ba1db4fd9da291db1363ff8
      size: 6107971
    - path: ../data/result/patterns_along_trajectories_MCC.pq
      md5: 89788ab7db179f59fc26469e4660e9a5
      size: 65179
    - path: ../data/result/patterns_along_trajectories_MEASURES.pq
      md5: 6e3beb184f76b7994377a804ba695a1b
      size: 71864
    - path: ../data/result/patterns_along_trajectories_SGFF.pq
      md5: 2e7b90d96f16556b006fc2969b74929f
      size: 93253
    outs:
    - path: ../figures/patterns_along_trajectory_MCC.pdf
      md5: 16b172d39820aec3c57c180d30d652f4
      size: 19389
    - path: ../figures/patterns_along_trajectory_MEASURES.pdf
      md5: bc888ec8848bfee22985ff26d2d69079
      size: 20381
    - path: ../figures/patterns_along_trajectory_SGFF.pdf
      md5: f79e7f97b9ff43494e957e9113426947
      size: 19648
  plot_patterns_along_traj_SGFF:
    cmd: python patterns_along_trajectory.py
    deps:
    - path: ../data/ERA5/trajectories/Trajectories_back_ClassificationCenters_IR.nc
      md5: dec7390e2ba1db4fd9da291db1363ff8
      size: 6107971
    - path: ../data/result/patterns_along_trajectories_SGFF.pq
      md5: 2e7b90d96f16556b006fc2969b74929f
      size: 93253
    outs:
    - path: ../figures/patterns_along_trajectory_SGFF_allTimes.pdf
      md5: 2cbf4ff3b2a9fe611c28205f85a4aaa5
      size: 14239
  download_MODIS_IO:
    cmd: bash run_download_MODIS.sh ../../setups/IndianOcean.yaml
    outs:
    - path: /mount/sgff/nfs/data/MODIS/Aqua_MODIS_IR/IndianOcean
      md5: b9adfabf75219d672dae0157959eb4ee.dir
      size: 11543864357
      nfiles: 4744
  download_MODIS_TB1:
    cmd: bash data/MODIS/run_download_MODIS.sh setups/TropicalBelt1.yaml
    deps:
    - path: setups/TropicalBelt1.yaml
      hash: md5
      md5: 9eb367db400eec4369ba6ed260c5d7eb
      size: 604
    outs:
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt1
      hash: md5
      md5: 4b696fe5351f73c534fb5a298e2b4880.dir
      size: 7753119461
      nfiles: 8400
  download_MODIS_TB2:
    cmd: bash data/MODIS/run_download_MODIS.sh setups/TropicalBelt2.yaml
    deps:
    - path: setups/TropicalBelt2.yaml
      hash: md5
      md5: f5a371caceb485d9a700688380b63d18
      size: 603
    outs:
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt2
      hash: md5
      md5: 7afa22696a7ff311a89d467742c61899.dir
      size: 9020460088
      nfiles: 8400
  download_MODIS_TB3:
    cmd: bash data/MODIS/run_download_MODIS.sh setups/TropicalBelt3.yaml
    deps:
    - path: setups/TropicalBelt3.yaml
      hash: md5
      md5: e213895ed40d61f79750200e9c0b71af
      size: 600
    outs:
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt3
      hash: md5
      md5: 5ed948cc18869825cfe3dda6f9de0090.dir
      size: 9093819834
      nfiles: 8400
  download_MODIS_TB4:
    cmd: bash data/MODIS/run_download_MODIS.sh setups/TropicalBelt4.yaml
    deps:
    - path: setups/TropicalBelt4.yaml
      hash: md5
      md5: 9cf6748ea9856852e5b3a4169ab039c0
      size: 599
    outs:
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt4
      hash: md5
      md5: 59e01c8b01acfdb3f9d5aafe6778708f.dir
      size: 10141225206
      nfiles: 8400
  download_MODIS_TB5:
    cmd: bash data/MODIS/run_download_MODIS.sh setups/TropicalBelt5.yaml
    deps:
    - path: setups/TropicalBelt5.yaml
      hash: md5
      md5: 882c75ca78731dd641ced5fec4cdb68d
      size: 601
    outs:
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt5
      hash: md5
      md5: 37ab5c076a4486800f593327fd3198f3.dir
      size: 9904151209
      nfiles: 8400
  download_MODIS_TB6:
    cmd: bash data/MODIS/run_download_MODIS.sh setups/TropicalBelt6.yaml
    deps:
    - path: setups/TropicalBelt6.yaml
      hash: md5
      md5: 31402c1d342db4e380ef508abaa62289
      size: 591
    outs:
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt6
      hash: md5
      md5: 1c56afc64f66c6af70e918c6d8650504.dir
      size: 10281843136
      nfiles: 8400
  download_MODIS_TB:
    cmd: echo "Download all MODIS Tropical Belt images"
    deps:
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt1
      hash: md5
      md5: 4b696fe5351f73c534fb5a298e2b4880.dir
      size: 7753119461
      nfiles: 8400
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt2
      hash: md5
      md5: 7afa22696a7ff311a89d467742c61899.dir
      size: 9020460088
      nfiles: 8400
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt3
      hash: md5
      md5: 5ed948cc18869825cfe3dda6f9de0090.dir
      size: 9093819834
      nfiles: 8400
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt4
      hash: md5
      md5: 59e01c8b01acfdb3f9d5aafe6778708f.dir
      size: 10141225206
      nfiles: 8400
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt5
      hash: md5
      md5: 37ab5c076a4486800f593327fd3198f3.dir
      size: 9904151209
      nfiles: 8400
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt6
      hash: md5
      md5: 1c56afc64f66c6af70e918c6d8650504.dir
      size: 10281843136
      nfiles: 8400
  stitch_images_BT:
    cmd: bash data/MODIS/stitch_images.sh .//data/MODIS/Aqua_MODIS_IR/TropicalBelt1/
      .//data/MODIS/Aqua_MODIS_IR/TropicalBelt2/ .//data/MODIS/Aqua_MODIS_IR/TropicalBelt3/
      .//data/MODIS/Aqua_MODIS_IR/TropicalBelt4/ .//data/MODIS/Aqua_MODIS_IR/TropicalBelt5/
      .//data/MODIS/Aqua_MODIS_IR/TropicalBelt6/
    deps:
    - path: /mount/sgff/nfs/data/MODIS/Aqua_MODIS_IR/TropicalBelt1
      md5: b09c4a130fab37274bd99daca9222146.dir
      size: 7454975615
      nfiles: 8035
    - path: /mount/sgff/nfs/data/MODIS/Aqua_MODIS_IR/TropicalBelt2
      md5: 6068207e6a6c0eb6156efdb0d54fb5e6.dir
      size: 8658700894
      nfiles: 8035
    - path: /mount/sgff/nfs/data/MODIS/Aqua_MODIS_IR/TropicalBelt3
      md5: 3fda88d5b84c9653f0f94739c05e0469.dir
      size: 8748532740
      nfiles: 8035
    - path: /mount/sgff/nfs/data/MODIS/Aqua_MODIS_IR/TropicalBelt4
      md5: 0e59f117cee94c508db48106a0fb8242.dir
      size: 9752440454
      nfiles: 8035
    - path: /mount/sgff/nfs/data/MODIS/Aqua_MODIS_IR/TropicalBelt5
      md5: 011de03af2ab8379bdc9abf5e1d0202c.dir
      size: 9531176496
      nfiles: 8035
    - path: /mount/sgff/nfs/data/MODIS/Aqua_MODIS_IR/TropicalBelt6
      md5: 38f23d0e687140fd773117bc4c6ca0c9.dir
      size: 9881643325
      nfiles: 8035
    outs:
    - path: .//data/MODIS/Aqua_MODIS_IR/TropicalBelt
      hash: md5
      md5: 67939c0019133cdd060b68a4a41bf5bc.dir
      size: 56102981498
      nfiles: 8400
  classify_MODIS_TB:
    cmd: bash ./data/MODIS/run_classification_world.sh setups/TropicalBelt.yaml
    outs:
    - path: .//data/SGFF/level0/TB/
      hash: md5
      md5: 5dfcde9278a6824610cc875f87a02fb2.dir
      size: 101431986
      nfiles: 18
  create_mask_TB:
    cmd: python src/helpers/convert_pkl_to_zarr.py setups/TropicalBelt.yaml
    deps:
    - path: .//data/SGFF/level0/TB
      hash: md5
      md5: 5dfcde9278a6824610cc875f87a02fb2.dir
      size: 101431986
      nfiles: 18
    outs:
    - path: ./data/SGFF/level0.5/TB/IR_TropicalBelt.pkl
      hash: md5
      md5: 126447e1c4789fb92249eaf78c4ce476
      size: 109239445
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/latitude
      hash: md5
      md5: f03c70169108c30fd1837e3fc64c1e6a.dir
      size: 6960
      nfiles: 3
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/longitude
      hash: md5
      md5: b01ba6be1ca3c078347f044fc6793ac8.dir
      size: 92640
      nfiles: 3
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/mask
      hash: md5
      md5: d618ce997d2254044fa680b2a83e759a.dir
      size: 4692645140
      nfiles: 7570
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/pattern
      hash: md5
      md5: 398e12946d92207bb3b291fb90aaa252.dir
      size: 370
      nfiles: 3
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/time
      hash: md5
      md5: 00c567d95defa51a689ec6bafe4b6baf.dir
      size: 39604
      nfiles: 3
  grid_mask_TB:
    cmd: python analysis/prepare_data_grid.py setups/TropicalBelt.yaml
    deps:
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr
      hash: md5
      md5: 41f03e31bf8d880a5a8723b33999db8e.dir
      size: 83550672706
      nfiles: 22699
    outs:
    - path: data/SGFF/level2/TB/
      hash: md5
      md5: 12b36c92065458732804fa27e022d622.dir
      size: 71386433
      nfiles: 15155
  mask_classifications:
    cmd: python data/MODIS/mask_footprint.py setups/TropicalBelt.yaml
    deps:
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/.zattrs
      hash: md5
      md5: 38a387dbed967fa82851311bd9b4765a
      size: 381
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/.zgroup
      hash: md5
      md5: e20297935e73dd0154104d4ea53040ab
      size: 24
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/.zmetadata
      hash: md5
      md5: c035e555d3bd6548d7a884e704fe45e2
      size: 5216
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/latitude
      hash: md5
      md5: f03c70169108c30fd1837e3fc64c1e6a.dir
      size: 6960
      nfiles: 3
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/longitude
      hash: md5
      md5: b01ba6be1ca3c078347f044fc6793ac8.dir
      size: 92640
      nfiles: 3
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/mask
      hash: md5
      md5: d618ce997d2254044fa680b2a83e759a.dir
      size: 4692645140
      nfiles: 7570
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/pattern
      hash: md5
      md5: 398e12946d92207bb3b291fb90aaa252.dir
      size: 370
      nfiles: 3
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/time
      hash: md5
      md5: 00c567d95defa51a689ec6bafe4b6baf.dir
      size: 39604
      nfiles: 3
    - path: data/MODIS/mask_footprint.py
      hash: md5
      md5: 8e110483dbda56fb3957da2be59457fd
      size: 5864
    outs:
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/sat_bt
      hash: md5
      md5: 2c9cd392f845dfad6c83893a078d6b67.dir
      size: 77450772826
      nfiles: 7557
    - path: ./data/SGFF/level1/TB/IR_TropicalBelt.zarr/sat_mask
      hash: md5
      md5: 26aff81403fdc920e2f831d1296ff50e.dir
      size: 1407109545
      nfiles: 7557
